function initmap(n,t){var i,r;window.baseProjection=new OpenLayers.Projection("EPSG:4326");window.googleProjection=new OpenLayers.Projection("EPSG:900913");i=new OpenLayers.Control.Navigation;i.defaultDblClick=function(n){var t=this.map.getLonLatFromViewPortPx(n.xy);this.map.zoom>13?this.map.setCenter(t):this.map.setCenter(t,this.map.zoom+1)};r={controls:[new OpenLayers.Control.PanZoom,new OpenLayers.Control.ArgParser,new OpenLayers.Control.ScaleLine,i,new OpenLayers.Control.Attribution,new OpenLayers.Control.LayerSwitcher],projection:window.baseProjection,displayProjection:window.googleProjection};window.map=new OpenLayers.Map(n,r);t&&t()}function initCompactMap(n,t){window.baseProjection=new OpenLayers.Projection("EPSG:4326");window.googleProjection=new OpenLayers.Projection("EPSG:900913");var i={controls:[new OpenLayers.Control.PanZoom,new OpenLayers.Control.ArgParser,new OpenLayers.Control.ScaleLine,new OpenLayers.Control.Navigation,new OpenLayers.Control.Attribution],projection:window.baseProjection,displayProjection:window.googleProjection};window.map=new OpenLayers.Map(n,i);t&&t()}function setupMap(){var n=new OpenLayers.Layer.Google("Google Streets",{numZoomLevels:20,sphericalMercator:!0});map.addLayers([n])}function setupVmMap(){if(window.VIETMAP_TILED>0){var n={layername:"basic",type:"png",sphericalMercator:!0,numZoomLevels:19,projection:window.baseProjector,displayProjection:window.googleProjector},t=new OpenLayers.Layer.XYZ("Google","http://s20.quanlyxe.vn/map-service/ImgHandler.ashx?action=tile&z=${z}&x=${x}&y=${y}",n);map.addLayers([t])}window.GOOGLE_MAP>0&&setupMap()}function setupCompactMap(){var n=new OpenLayers.Layer.Google("Google Streets",{numZoomLevels:20,sphericalMercator:!0});map.addLayers([n])}function getLonLatTransform(n,t){var i=new OpenLayers.LonLat(n/1e6,t/1e6);return i.transform(baseProjection,googleProjection),i}function getPointTransform(n,t){var i=new OpenLayers.Geometry.Point(n/1e6,t/1e6);return i.transform(baseProjection,googleProjection),i}function getPointFromGoogleLatLon(n,t){var i=new OpenLayers.Geometry.Point(t,n);return i.transform(baseProjection,googleProjection),i}function getLonLatGoogleLatLon(n,t){var i=new OpenLayers.LonLat(t,n);return i.transform(baseProjection,googleProjection)}function convertPointtoLonlat(n){return new OpenLayers.LonLat(n.x,n.y)}function convertLonLattoPoint(n){return new OpenLayers.Geometry.Point(n.lon,n.lat)}function getGoogleLonlatFromPoint(n){var t=new OpenLayers.LonLat(n.x,n.y);return t.transform(googleProjection,baseProjection)}function getGoogleLonlatFromLonlat(n){return n.transform(googleProjection,baseProjection)}function setRotatePlate(){for(var n,i=document.getElementsByTagName("image"),t=0;t<i.length;t++)n=i.item(t),n.getAttribute("id")!=null&&n.getAttribute("id").indexOf("background")!=-1&&n.setAttribute("transform","rotate(0)")}function setCenter(n){resetZoom();map.setCenter(convertPointtoLonlat(n))}function resetZoom(){map.zoomTo(15)}function removeCurrentPopup(){window.curPopU&&window.curPopU!=null&&(map.removePopup(window.curPopU),window.curPopU=null)}function setCurrentPopup(n){window.curPopU=n}function updateMap(){setTimeout(function(){window.map&&window.map.updateSize()},500)}function resetMap(){window.vector&&window.vector.removeAllFeatures();removeCurrentPopup()}function zoomToBounds(n){for(var r,f,u=new OpenLayers.Bounds,i=n.split(";"),t=0;t<i.length;t++)i[t].length>0&&(r=i[t].split(","),f=getPointTransform(r[0],r[1]),u.extend(f));map.zoomToExtent(u,!0);map.zoomOut()}function paddingDisplay2Number(n){return(n=parseInt(n),n<10)?"0"+n:n}function getTimeFromJson(n){return n&&n>0?new Date(n):null}function getTime(n){if(n==0)return"";var t=getBaseTime();return t.setSeconds(n),t}function getBaseTime(){return new Date(2010,0,1,0,0,0,0)}function getSecounds2Dates(n,t){return parseInt((n.getTime()-t.getTime())/1e3)}function formatDateTime(n){return n?paddingDisplay2Number(n.getDate())+"-"+paddingDisplay2Number(n.getMonth()+1)+" "+paddingDisplay2Number(n.getHours())+":"+paddingDisplay2Number(n.getMinutes())+":"+paddingDisplay2Number(n.getSeconds()):""}function formatDate(n){return n?paddingDisplay2Number(n.getDate())+"-"+paddingDisplay2Number(n.getMonth()+1)+"-"+paddingDisplay2Number(n.getYear()):""}function formatTime(n){return n?paddingDisplay2Number(n.getHours())+":"+paddingDisplay2Number(n.getMinutes())+":"+paddingDisplay2Number(n.getSeconds()):""}function formatTime2(n){return n?paddingDisplay2Number(n.getHours())+":"+paddingDisplay2Number(n.getMinutes()):""}function getDuration(n){var t,i,r;return n[17]>0?(t="",n[9][3]>0?(i=n[9][3]/1440,r=n[9][3]%1440,i>0&&(t=i+" d"),t=t+paddingDisplay2Number(r/60)+":"+paddingDisplay2Number(r%60)):t="00:00",t):"00:00"}function getRegionById(n,t){return regions[n]?regions[n]+t:""+t}function getRegion(n){return getRegionById(n&16777215," ")+getRegionById(n&65535," ")+getRegionById(n&255,"")}function getRegionById2(n,t){return regions2[n]?regions2[n]+t:""+t}function getRegion2(n){return getRegionById2(n&16777215," ")+getRegionById2(n&65535," ")+getRegionById2(n&255,"")}function Gis(){}function formatString(n){return n?n:""}function formatDistance(n){return n>1e3?Util.number.format(parseInt(n/100)/10)+" Km":Util.number.format(parseInt(n))+" m"}function getLonLatBaseOnAddress(n,t){$.get("http://maps.googleapis.com/maps/api/geocode/json",{sensor:!1,language:"vi-VN",address:n+" "+window.baseCity+" Viet Nam"},function(n){t!=null&&t(n)})}function getLonLatBaseOnAddress2(n,t){$.get("http://maps.googleapis.com/maps/api/geocode/json",{sensor:!1,language:"vi-VN",address:n+" Viet Nam"},function(n){t!=null&&t(n)})}function getLonlatBaseAdd(n,t){$.post(Url.get("Monitor/Geocode"),{address:n},function(n){t!=null&&t(n)})}function getAddressBaseOnLonLat(){}function formatDistanceNoUnit(n){return n&&n>0?Util.number.format(parseInt(n/10)/10):0}function formatGPSDistanceNoUnit(n){return n&&n>0?Util.number.format(parseInt(n/100)/10):0}function getMapFreeLineColor(){return window.mapFreeLineColor?window.mapFreeLineColor:"red"}function getMapPassengerLineColor(){return window.mapPassengerLineColor?window.mapPassengerLineColor:"green"}function angleFromCoordinate(n,t,i,r){return Math.atan2(i-n,r-t)*180/Math.PI}var map,baseProjection,googleProjection,regions=[],regions2=[];Gis.deg2Rad=function(n){return n*Math.PI/180};Gis.getDistance=function(n,t,i,r){return this.getDistances(n/1e6,t/1e6,i/1e6,r/1e6)};Gis.getDistances=function(n,t,i,r){var u=this.deg2Rad(t),o=this.deg2Rad(n),f=this.deg2Rad(r),s=this.deg2Rad(i),h=f-u,c=s-o,e=Math.pow(Math.sin(h/2),2)+Math.cos(u)*Math.cos(f)*Math.pow(Math.sin(c/2),2),l=2*Math.atan2(Math.sqrt(e),Math.sqrt(1-e));return parseInt(l*6373e3)};